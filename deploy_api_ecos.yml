---
 - hosts: all
   become: true
   vars:
     - script: "./deploy.sh"
   tasks:
   - name: Transfer the script
     copy: src=/opt/deploy.sh dest=/home/ansible owner=ansible group=ansible mode=0777
 
   - name: deploy jboss
     shell:
        "{{ script | quote}} {{ instance_url }}"

     with_items:
       - "{{ instance_url }}"
     when: instance_url is defined
     register: result
     ignore_errors: yes
     args:
        chdir: "/home/ansible/"
        executable: /bin/bash

   - debug:
       msg: "Deployment successfull"
                  

